



```{r}
library(ggplot2)
library(dplyr)

calories <- readLines("inputs/day1.txt")
calories <- data.frame(calories = calories)
calories$elf <- cumsum(calories$calories == "") + 1
calories <- calories[calories$calories != "", ]
calories$calories <- as.integer(calories$calories)
```
The average calorie allotment per elf is `r mean(calories$calories)`. This is
substantially higher than the median, `r median(calories$calories)`. This disparity is remarkable, given the large size of the `r length(unique(calories$elf))`-elf expedition.

```{r}
calories_grouped <- tapply(calories$calories,calories$elf, sum )
calories_grouped <- data.frame(elf = names(calories_grouped), calories = calories_grouped)
calories_grouped$elf <- factor(calories_grouped$elf, levels = calories_grouped$elf[order(calories_grouped$calories, decreasing = TRUE )])
calories_grouped <- calories_grouped[match(levels(calories_grouped$elf), calories_grouped$elf),]

ggplot(calories_grouped, aes(x = elf, y = calories)) +
geom_col(fill = "red") +
labs(x = "", y = "Elf Calorie Allotment", title = "Calories per Elf") +
theme(axis.text.x = element_blank(),
axis.ticks.x = element_blank(),
panel.grid = element_blank())
```

Assuming a 25-day expedition, the total
supply of `r sum(calories$calories)` would
sustain each elf on `r floor(sum(calories$calories) / (25 * nrow(calories_grouped)` per day. This would not be nearly enough to sustain a human, given the intense
exertion involved in blazing a path through
dense jungle. However, because elves are tiny and also magical, it should be more
than sufficient.

```{r}
ggplot(calories_grouped[1:20,], aes(elf, calories, group = 1)) +
geom_step()
```

```{r}
ggplot(calories_grouped[1:40,],
    aes(y =  cumsum(calories), x = elf,  group = 1, fill = elf)) +
geom_step() +
labs(title = "Calories per Elf", y = "Elf Number", x = "Cumulative Calories Allotted")
```

```{r}
ggplot(calories_grouped, aes(calories)) +
geom_density()
```
